<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>OGScope - 电子极轴镜</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4a90e2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="OGScope">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#4a90e2">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/static/images/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/images/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/images/icon-192x192.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/static/images/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/images/icon-16x16.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/static/css/style.css">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="/static/js/app.js" as="script">
    <link rel="preload" href="/static/css/style.css" as="style">
</head>
<body>
    <div id="app">
        <header>
            <h1>OGScope</h1>
            <p>电子极轴镜控制台</p>
        </header>

        <main>
            <section class="camera-preview">
                <h2>实时预览</h2>
                <div class="video-container">
                    <img id="preview" src="/api/camera/preview" alt="相机预览">
                </div>
            </section>

            <section class="controls">
                <h2>相机控制</h2>
                <div class="control-group">
                    <label for="exposure">曝光时间 (ms):</label>
                    <input type="range" id="exposure" min="1" max="1000" value="10">
                    <span id="exposure-value">10</span>
                </div>
                <div class="control-group">
                    <label for="gain">增益:</label>
                    <input type="range" id="gain" min="1" max="16" step="0.1" value="1">
                    <span id="gain-value">1.0</span>
                </div>
            </section>

            <section class="polar-align">
                <h2>极轴校准</h2>
                <button id="start-align" class="btn btn-primary">开始校准</button>
                <button id="stop-align" class="btn btn-secondary" disabled>停止校准</button>
                <div class="status">
                    <p>状态: <span id="align-status">未开始</span></p>
                    <p>方位误差: <span id="az-error">--</span> 角分</p>
                    <p>高度误差: <span id="alt-error">--</span> 角分</p>
                </div>
            </section>
        </main>

        <footer>
            <p>OGScope v0.1.0 | <a href="/docs">API 文档</a></p>
        </footer>
    </div>

    <!-- 网络状态指示器 -->
    <div class="network-status offline" id="network-status"></div>
    
    <!-- PWA安装提示 -->
    <div class="install-prompt" id="install-prompt">
        <div class="install-prompt-content">
            <div class="install-prompt-text">
                <h3>安装 OGScope</h3>
                <p>添加到主屏幕，获得更好的使用体验</p>
            </div>
            <div class="install-prompt-actions">
                <button class="btn btn-primary" id="install-app">安装</button>
                <button class="btn btn-secondary" id="dismiss-install">稍后</button>
            </div>
        </div>
    </div>

    <!-- 标签页导航 -->
    <div class="tab-navigation">
        <button class="tab-button active" data-tab="camera">📷 相机</button>
        <button class="tab-button" data-tab="controls">⚙️ 控制</button>
        <button class="tab-button" data-tab="alignment">🎯 校准</button>
    </div>

    <!-- 相机标签页 -->
    <div id="tab-camera" class="tab-content active">
        <div class="card camera-preview">
            <div class="card-header">
                <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
                </svg>
                <h2>实时预览</h2>
            </div>
            
            <div class="video-container">
                <img id="preview" src="/static/images/placeholder-camera.png" alt="相机预览">
                <div class="video-overlay" id="video-overlay">
                    点击开始预览
                </div>
            </div>
            
            <div class="video-controls">
                <button class="btn btn-primary" id="start-preview">开始预览</button>
                <button class="btn btn-secondary" id="stop-preview" disabled>停止预览</button>
            </div>
        </div>
    </div>

    <!-- 控制标签页 -->
    <div id="tab-controls" class="tab-content">
        <div class="card">
            <div class="card-header">
                <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                </svg>
                <h2>相机控制</h2>
            </div>
            
            <div class="camera-controls">
                <div class="control-group">
                    <label for="exposure">曝光时间 (ms)</label>
                    <div class="control-row">
                        <input type="range" id="exposure" min="1" max="1000" value="10" step="1">
                        <span class="control-value" id="exposure-value">10</span>
                    </div>
                </div>
                
                <div class="control-group">
                    <label for="gain">模拟增益</label>
                    <div class="control-row">
                        <input type="range" id="gain" min="1" max="16" step="0.1" value="1.0">
                        <span class="control-value" id="gain-value">1.0</span>
                    </div>
                </div>
                
                <div class="control-group">
                    <label for="brightness">亮度调节</label>
                    <div class="control-row">
                        <button class="btn btn-secondary" onclick="window.ogscopeApp.adjustCameraBrightness(-0.1)">-</button>
                        <span class="control-value">双击预览区域缩放，上下滑动调节亮度</span>
                        <button class="btn btn-secondary" onclick="window.ogscopeApp.adjustCameraBrightness(0.1)">+</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 极轴校准标签页 -->
    <div id="tab-alignment" class="tab-content">
        <div class="card polar-alignment">
            <div class="card-header">
                <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
                </svg>
                <h2>极轴校准</h2>
            </div>
            
            <div class="alignment-controls">
                <button class="btn btn-primary" id="start-align">
                    <span class="loading" style="display: none;"></span>
                    开始校准
                </button>
                <button class="btn btn-secondary" id="stop-align" disabled>停止校准</button>
            </div>
            
            <div class="alignment-status">
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">校准状态</div>
                        <div class="status-value" id="align-status">未开始</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">方位误差</div>
                        <div class="status-value" id="az-error">--</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">高度误差</div>
                        <div class="status-value" id="alt-error">--</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">精度等级</div>
                        <div class="status-value status-good" id="precision-level">--</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>

